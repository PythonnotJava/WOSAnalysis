import matplotlib.pyplot as plt
import circlify
import pandas as pd

# 准备数据
journal_counts = {'ENERGIES': 12, 'OCEAN ENGINEERING': 37, 'INTERNATIONAL JOURNAL OF HYDROGEN ENERGY': 7, 'JOURNAL OF CLIMATE': 13, 'JOURNAL OF CLEANER PRODUCTION': 8, 'IET RENEWABLE POWER GENERATION': 1, 'NATURE COMMUNICATIONS': 4, 'APPLIED THERMAL ENGINEERING': 3, 'ENERGY': 16, 'CSEE JOURNAL OF POWER AND ENERGY SYSTEMS': 1, 'SURVEYS IN GEOPHYSICS': 1, 'APPLIED SCIENCES-BASEL': 2, 'JOURNAL OF HYDRODYNAMICS': 1, 'JOURNAL OF OFFSHORE MECHANICS AND ARCTIC ENGINEERING-TRANSACTIONS OF THE': 7, 'NANO ENERGY': 17, 'APPLIED ENERGY': 14, 'RENEWABLE ENERGY': 15, 'JOURNAL OF SOLAR ENERGY ENGINEERING-TRANSACTIONS OF THE ASME': 1, 'JOURNAL OF MARINE SCIENCE AND ENGINEERING': 16, 'ESTUARIES AND COASTS': 2, 'IEEE INTERNET OF THINGS JOURNAL': 6, 'MATTER': 1, 'JOURNAL OF NAVIGATION': 1, 'JOURNAL OF MARINE SCIENCE AND TECHNOLOGY': 1, 'IEEE TRANSACTIONS ON SUSTAINABLE ENERGY': 4, 'DESALINATION': 3, 'SENSORS AND ACTUATORS A-PHYSICAL': 1, 'SCIENTIA IRANICA': 1, 'SCIENCE OF ADVANCED MATERIALS': 1, 'JOURNAL OF ENERGY STORAGE': 5, 'JOURNAL OF BUILDING ENGINEERING': 1, 'INTERNATIONAL JOURNAL OF ENERGY RESEARCH': 2, 'THERMAL SCIENCE AND ENGINEERING PROGRESS': 3, 'SCIENCE CHINA-TECHNOLOGICAL SCIENCES': 1, 'SCIENCE ADVANCES': 1, 'JOURNAL OF ADVANCES IN MODELING EARTH SYSTEMS': 9, 'JOURNAL OF PHYSICAL OCEANOGRAPHY': 5, 'ENERGY REPORTS': 2, 'IEEE TRANSACTIONS ON INDUSTRY APPLICATIONS': 1, 'JOURNAL OF GEOPHYSICAL RESEARCH-PLANETS': 1, 'PHYSICAL REVIEW LETTERS': 1, 'ADVANCED ENGINEERING MATERIALS': 1, 'FRONTIERS IN ENERGY RESEARCH': 3, 'POLISH MARITIME RESEARCH': 3, 'ADVANCED ENERGY MATERIALS': 4, 'JOURNAL OF GEOPHYSICAL RESEARCH-BIOGEOSCIENCES': 1, 'MARINE POLLUTION BULLETIN': 1, 'ENVIRONMENTAL RESEARCH LETTERS': 2, 'JOURNAL OF MATERIALS CHEMISTRY A': 1, 'BOUNDARY-LAYER METEOROLOGY': 1, 'GEOSCIENTIFIC MODEL DEVELOPMENT': 15, 'ENERGY CONVERSION AND MANAGEMENT': 6, 'OCEAN MODELLING': 8, 'IEEE SYSTEMS JOURNAL': 1, 'CHINESE JOURNAL OF MECHANICAL ENGINEERING': 1, 'QUALITY AND RELIABILITY ENGINEERING INTERNATIONAL': 1, 'CASE STUDIES IN THERMAL ENGINEERING': 2, 'NANO RESEARCH': 2, 'JOURNAL OF ENERGY RESOURCES TECHNOLOGY-TRANSACTIONS OF THE ASME': 1, 'OCEAN SCIENCE JOURNAL': 1, 'MINERALS': 2, 'SMALL': 1, 'ENVIRONMENT DEVELOPMENT AND SUSTAINABILITY': 1, 'CLIMATE DYNAMICS': 8, 'GEOPHYSICAL RESEARCH LETTERS': 10, 'RENEWABLE & SUSTAINABLE ENERGY REVIEWS': 8, 'FRONTIERS IN MARINE SCIENCE': 13, 'OCEAN DYNAMICS': 3, 'BIOPROCESS AND BIOSYSTEMS ENGINEERING': 1, 'ARCTIC': 1, 'MEMBRANES': 1, 'IEEE ACCESS': 5, 'ADVANCED MATERIALS TECHNOLOGIES': 2, 'BATTERIES & SUPERCAPS': 1, 'IEEE TRANSACTIONS ON TRANSPORTATION ELECTRIFICATION': 1, 'LIMNOLOGY AND OCEANOGRAPHY': 2, 'SOLAR ENERGY': 1, 'NATURE CLIMATE CHANGE': 3, 'EARTH SYSTEM SCIENCE DATA': 2, 'ENERGY FOR SUSTAINABLE DEVELOPMENT': 1, 'INTERNATIONAL TRANSACTIONS ON ELECTRICAL ENERGY SYSTEMS': 1, 'ATMOSPHERIC CHEMISTRY AND PHYSICS': 4, 'QUARTERLY JOURNAL OF THE ROYAL METEOROLOGICAL SOCIETY': 3, 'SCIENCE OF THE TOTAL ENVIRONMENT': 6, 'LIMNOLOGY AND OCEANOGRAPHY-METHODS': 1, 'IEEE JOURNAL OF OCEANIC ENGINEERING': 1, 'ADVANCED FUNCTIONAL MATERIALS': 2, 'ACS SUSTAINABLE CHEMISTRY & ENGINEERING': 2, 'IEEE WIRELESS COMMUNICATIONS LETTERS': 1, 'JOURNAL OF COMMUNICATIONS TECHNOLOGY AND ELECTRONICS': 1, 'COMMUNICATIONS EARTH & ENVIRONMENT': 2, 'JOURNAL OF GEOPHYSICAL RESEARCH-OCEANS': 10, 'PALEOCEANOGRAPHY AND PALEOCLIMATOLOGY': 1, 'SUSTAINABLE ENERGY TECHNOLOGIES AND ASSESSMENTS': 1, 'INTERNATIONAL JOURNAL OF MINERALS METALLURGY AND MATERIALS': 1, 'ATMOSPHERIC RESEARCH': 1, 'MARINE AND COASTAL FISHERIES': 1, 'MEDITERRANEAN MARINE SCIENCE': 1, 'OCEAN SCIENCE': 4, 'SCIENTIFIC REPORTS': 2, 'MATERIALS TODAY SUSTAINABILITY': 1, 'ENVIRONMENTAL SCIENCE AND POLLUTION RESEARCH': 3, 'OCEANOGRAPHY': 1, 'AQUATIC GEOCHEMISTRY': 1, 'ELECTROCHIMICA ACTA': 1, 'ENERGY & ENVIRONMENTAL SCIENCE': 3, 'RESEARCH IN ASTRONOMY AND ASTROPHYSICS': 1, 'JOURNAL OF APPLIED METEOROLOGY AND CLIMATOLOGY': 2, 'PALAEOGEOGRAPHY PALAEOCLIMATOLOGY PALAEOECOLOGY': 1, 'JOURNAL OF MARINE ENGINEERING AND TECHNOLOGY': 1, 'JOURNAL OF ATMOSPHERIC AND OCEANIC TECHNOLOGY': 2, 'JOURNAL OF EARTHQUAKE AND TSUNAMI': 1, 'AIP ADVANCES': 1, 'SCIENCE CHINA-EARTH SCIENCES': 1, 'GLOBAL BIOGEOCHEMICAL CYCLES': 1, 'JOURNAL OF OCEAN UNIVERSITY OF CHINA': 2, 'SENSORS': 4, 'ARCHAEOMETRY': 1, 'JOURNAL OF MATERIAL CYCLES AND WASTE MANAGEMENT': 1, 'IEEE LATIN AMERICA TRANSACTIONS': 1, 'ELECTRIC POWER COMPONENTS AND SYSTEMS': 1, 'JOURNAL OF WATERWAY PORT COASTAL AND OCEAN ENGINEERING': 1, 'SUSTAINABLE PRODUCTION AND CONSUMPTION': 2, 'JOURNAL OF PHASE EQUILIBRIA AND DIFFUSION': 1, 'DYNAMICS OF ATMOSPHERES AND OCEANS': 2, 'MOLECULAR CATALYSIS': 1, 'EARTHS FUTURE': 1, 'JOURNAL OF OCEANOLOGY AND LIMNOLOGY': 2, 'TRANSPORTATION RESEARCH PART D-TRANSPORT AND ENVIRONMENT': 1, 'NONLINEAR DYNAMICS': 1, 'JOURNAL OF ECONOMETRICS': 1, 'PROGRESS IN NUCLEAR ENERGY': 1, 'JOURNAL OF POWER SOURCES': 2, 'KSII TRANSACTIONS ON INTERNET AND INFORMATION SYSTEMS': 1, 'JOURNAL OF MARINE SYSTEMS': 2, 'REMOTE SENSING': 7, 'IEEE NETWORK': 1, 'IEEE TRANSACTIONS ON GEOSCIENCE AND REMOTE SENSING': 2, 'IEEE TRANSACTIONS ON MOBILE COMPUTING': 1, 'JOURNAL OF RENEWABLE AND SUSTAINABLE ENERGY': 1, 'MARINE TECHNOLOGY SOCIETY JOURNAL': 4, 'JOURNAL OF THE ATMOSPHERIC SCIENCES': 4, 'COMPEL-THE INTERNATIONAL JOURNAL FOR COMPUTATION AND MATHEMATICS IN': 1, 'MARINE GEORESOURCES & GEOTECHNOLOGY': 1, 'IEEE PHOTONICS JOURNAL': 1, 'ATMOSPHERE': 3, 'JOURNAL OF INTELLIGENT & ROBOTIC SYSTEMS': 1, 'NATURAL HAZARDS': 2, 'JOHNSON MATTHEY TECHNOLOGY REVIEW': 1, 'PROCESS SAFETY AND ENVIRONMENTAL PROTECTION': 1, 'NANOSCALE': 1, 'JOURNAL OF SUPERCOMPUTING': 1, 'RUSSIAN METEOROLOGY AND HYDROLOGY': 1, 'DEEP-SEA RESEARCH PART I-OCEANOGRAPHIC RESEARCH PAPERS': 1, 'COMPLEXITY': 1, 'DESALINATION AND WATER TREATMENT': 1, 'PHYSICAL REVIEW E': 1, 'JOURNAL OF COMPUTATIONAL SCIENCE': 1, 'CRYOSPHERE': 2, 'JOURNAL OF PHYSICS A-MATHEMATICAL AND THEORETICAL': 1, 'MBIO': 1, 'PROGRESS IN OCEANOGRAPHY': 2, 'DIVERSITY AND DISTRIBUTIONS': 1, 'GEOCHIMICA ET COSMOCHIMICA ACTA': 2, 'NONLINEAR PROCESSES IN GEOPHYSICS': 2, 'MATERIALS TODAY': 1, 'FRONTIERS IN ECOLOGY AND THE ENVIRONMENT': 1, 'JOURNAL OF COASTAL RESEARCH': 3, 'ACS APPLIED MATERIALS & INTERFACES': 1, 'GEOPHYSICAL AND ASTROPHYSICAL FLUID DYNAMICS': 2, 'OPTICAL AND QUANTUM ELECTRONICS': 2, 'JOURNAL OF MARINE RESEARCH': 1, 'BULLETIN OF THE AMERICAN METEOROLOGICAL SOCIETY': 2, 'DIGITAL COMMUNICATIONS AND NETWORKS': 1, 'PROCEEDINGS OF THE NATIONAL ACADEMY OF SCIENCES OF THE UNITED STATES OF': 1, 'APPLIED OCEAN RESEARCH': 2, 'SUSTAINABLE MATERIALS AND TECHNOLOGIES': 1, 'PHYSICAL REVIEW FLUIDS': 1, 'FISH AND FISHERIES': 1, 'METEOROLOGICAL APPLICATIONS': 1, 'JOURNAL OF ENVIRONMENTAL MANAGEMENT': 1, 'ACTA OCEANOLOGICA SINICA': 1, 'ENVIRONMENTAL RESEARCH': 1, 'JOURNAL OF GEOPHYSICAL RESEARCH-SOLID EARTH': 2, 'JOURNAL OF TROPICAL METEOROLOGY': 1, 'ECOLOGICAL MODELLING': 2, 'SUSTAINABLE CITIES AND SOCIETY': 1, 'IEEE TRANSACTIONS ON AEROSPACE AND ELECTRONIC SYSTEMS': 1, 'JOURNAL OF LOW FREQUENCY NOISE VIBRATION AND ACTIVE CONTROL': 1, 'BIOGEOSCIENCES': 3, 'FRACTAL AND FRACTIONAL': 1, 'INTEGRATIVE AND COMPARATIVE BIOLOGY': 1, 'INDIAN JOURNAL OF GEO-MARINE SCIENCES': 1, 'GEOPHYSICAL JOURNAL INTERNATIONAL': 1, 'ESTUARINE COASTAL AND SHELF SCIENCE': 2, 'INTERNATIONAL JOURNAL OF REMOTE SENSING': 1, 'ECOTOXICOLOGY AND ENVIRONMENTAL SAFETY': 1, 'SUSTAINABILITY': 4, 'ADVANCES IN ATMOSPHERIC SCIENCES': 1, 'AIN SHAMS ENGINEERING JOURNAL': 1, 'JOURNAL OF FLUID MECHANICS': 1, 'GLOBAL CHANGE BIOLOGY': 1, 'JOURNAL OF EXPERIMENTAL MARINE BIOLOGY AND ECOLOGY': 1, 'MARINE ENVIRONMENTAL RESEARCH': 1, 'REMOTE SENSING OF ENVIRONMENT': 1, 'NPJ CLIMATE AND ATMOSPHERIC SCIENCE': 1, 'HYDROBIOLOGIA': 1, 'SUSTAINABILITY SCIENCE': 1, 'APPLIED OPTICS': 1, 'INTERNATIONAL JOURNAL OF STRUCTURAL STABILITY AND DYNAMICS': 1, 'ENGINEERING ANALYSIS WITH BOUNDARY ELEMENTS': 1, 'REVIEW OF SCIENTIFIC INSTRUMENTS': 1, 'GREEN CHEMISTRY': 1, 'JOURNAL OF INDUSTRIAL ECOLOGY': 2, 'DEEP-SEA RESEARCH PART II-TOPICAL STUDIES IN OCEANOGRAPHY': 1, 'ECOHYDROLOGY & HYDROBIOLOGY': 1, 'EUROPEAN JOURNAL OF MECHANICS B-FLUIDS': 1, 'PHYSICS OF FLUIDS': 1, 'GLOBAL ECOLOGY AND BIOGEOGRAPHY': 1, 'AMERICAN NATURALIST': 1, 'ENVIRONMENTAL DEVELOPMENT': 1, 'JOURNAL OF GEOPHYSICAL RESEARCH-EARTH SURFACE': 1, 'AUSTRALIAN JOURNAL OF EARTH SCIENCES': 1, 'COMPUTER PHYSICS COMMUNICATIONS': 2, 'WEATHER AND FORECASTING': 1, 'DIVERSITY-BASEL': 1, 'PURE AND APPLIED GEOPHYSICS': 1, 'IEEE-ASME TRANSACTIONS ON MECHATRONICS': 1, 'ARABIAN JOURNAL OF GEOSCIENCES': 1, 'ENVIRONMENTAL SCIENCE & POLICY': 1, 'JOURNAL OF COASTAL CONSERVATION': 1, 'APPLIED MICROBIOLOGY AND BIOTECHNOLOGY': 1, 'MONTHLY WEATHER REVIEW': 1, 'EARTH SYSTEM DYNAMICS': 2, 'ASTRONOMICAL JOURNAL': 1, 'HYDROLOGICAL PROCESSES': 1, 'JOURNAL OF COMMUNICATIONS AND NETWORKS': 1, 'COASTAL ENGINEERING': 1, 'INTERNATIONAL JOURNAL OF MECHANICAL SCIENCES': 1, 'CLIMATE OF THE PAST': 1, 'JOURNAL OF DENTISTRY': 1, 'CANADIAN JOURNAL OF CHEMICAL ENGINEERING': 1, 'JOURNAL OF GEOPHYSICAL RESEARCH-ATMOSPHERES': 3, 'GEOCHEMISTRY GEOPHYSICS GEOSYSTEMS': 2, 'SEDIMENTARY GEOLOGY': 2, 'ECOLOGY': 1, 'GLOBAL ENVIRONMENTAL CHANGE-HUMAN AND POLICY DIMENSIONS': 1, 'EARTH-SCIENCE REVIEWS': 2, 'FISHERIES OCEANOGRAPHY': 1, 'GEOMORPHOLOGY': 1, 'SOIL & TILLAGE RESEARCH': 1, 'MSYSTEMS': 1, 'JOURNAL OF PHYSICAL CHEMISTRY C': 1, 'CRETACEOUS RESEARCH': 1, 'GLOBAL AND PLANETARY CHANGE': 1}

# 转为 dataframe 并排序
df = pd.DataFrame(journal_counts.items(), columns=["Journal", "Count"])
df = df.sort_values("Count", ascending=False)

# 使用 circlify 计算圆的位置
circles = circlify.circlify(
    df["Count"].tolist(),
    show_enclosure=False,
    target_enclosure=circlify.Circle(x=0, y=0, r=1)
)

# 画图
fig, ax = plt.subplots(figsize=(10, 10))
ax.axis('off')
ax.set_aspect('equal')

# 画每个圆
for circle, row in zip(circles, df.itertuples()):
    x, y, r = circle.x, circle.y, circle.r
    ax.add_patch(plt.Circle((x, y), r, alpha=0.6, linewidth=2))
    plt.text(x, y, row.Journal[:15], ha='center', va='center', fontsize=8)

plt.title("均匀分布气泡图：期刊文章数量", fontsize=14)
plt.show()
